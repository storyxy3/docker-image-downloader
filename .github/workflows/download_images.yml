name: Download Docker Images
on:
  workflow_dispatch:
    inputs:
      go_version:
        description: 'Go version (e.g., 1.25-alpine3.22)'
        default: '1.25-alpine3.22'
        required: false
      alpine_version:
        description: 'Alpine version (e.g., 3.22)'
        default: '3.22'
        required: false

jobs:
  download:
    runs-on: ubuntu-latest
    steps:
      - name: Set up Docker
        uses: docker/setup-buildx-action@v2

      - name: Pull Docker images
        run: |
          echo "ðŸ” æ‹‰å– Go é•œåƒ: golang:${{ github.event.inputs.go_version }}"
          docker pull golang:${{ github.event.inputs.go_version }}
          
          echo "ðŸ” æ‹‰å– Alpine é•œåƒ: alpine:${{ github.event.inputs.alpine_version }}"
          docker pull alpine:${{ github.event.inputs.alpine_version }}

      - name: Verify images
        run: |
          echo "ðŸ“‹ éªŒè¯é•œåƒ..."
          docker images | grep -E "(golang|alpine)"
          
          echo "ðŸ” æµ‹è¯• Go é•œåƒ..."
          docker run --rm golang:${{ github.event.inputs.go_version }} go version
          
          echo "ðŸ” æµ‹è¯• Alpine é•œåƒ..."
          docker run --rm alpine:${{ github.event.inputs.alpine_version }} cat /etc/alpine-release

      - name: Save images to tar
        run: |
          echo "ðŸ“¦ æ‰“åŒ…é•œåƒ..."
          docker save golang:${{ github.event.inputs.go_version }} alpine:${{ github.event.inputs.alpine_version }} > base-images.tar
          ls -lh base-images.tar

      - name: Upload artifact
        uses: actions/upload-artifact@v3
        with:
          name: docker-base-images
          path: base-images.tar
          retention-days: 7

      - name: Summary
        run: |
          echo "## ðŸŽ‰ ä¸‹è½½å®Œæˆ" >> $GITHUB_STEP_SUMMARY
          echo "æ–‡ä»¶: base-images.tar" >> $GITHUB_STEP_SUMMARY
          echo "å¤§å°: $(ls -lh base-images.tar | awk '{print $5}')" >> $GITHUB_STEP_SUMMARY
          echo "è¯·åœ¨ Artifacts ä¸­ä¸‹è½½æ–‡ä»¶" >> $GITHUB_STEP_SUMMARY